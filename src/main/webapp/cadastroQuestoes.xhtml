<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/layout.xhtml"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:jsf="http://xmlns.jcp.org/jsf">

    <ui:define name="content">
        <p:panel id="painel_conteudo" styleClass="color" header="Projeto TCS">
            <div id="header-name" >
                <p:panel id="panel_cadastro_questao">
                    <style type="text/css">
                        .label {
                            width: 20%;
                            padding: 4px;
                        }

                        .value {
                            width: 80%;
                            padding: 4px;
                        }

                        .grid {
                            width: 100%;
                        }

                        .error {
                            color: red;
                        }

                        .outputLabel {
                            font-weight: bold;
                        }

                        .grid {
                            width: 33%;
                            padding: 4px;
                        }

                        .grid-radio td {
                            padding: .5rem;
                        }
                    </style>                    
                    <div class="card">

                        <h:form>
                            <p:growl id="growl" sticky="true" showDetail="true"/>

                            <p:wizard flowListener="#{perguntaC.onFlowProcess}">

                                <!--      PERGUNTAS  E CATEGORIAS   -->

                                <p:tab id="tab_pergunta" title="Pergunta">
                                    <p:messages for="Pergunta" closable="true" showIcon="false"/>
                                    <p:panel header="Cadastro de Pergunta">                                        
                                        <p:panelGrid columns="1" columnClasses="label, value" style="margin:0 auto">                                            
                                            <p:outputLabel value="Digite sua pergunta" for="Pergunta"/>
                                            <p:inputText id="Pergunta" value="#{perguntaC.pergunta.texto}" 
                                                         required="true" 
                                                         label=" " 
                                                         maxlength="255"
                                                         style="width:100%"
                                                         placeholder="Digite a pergunta *">
                                                <f:validateLength minimum="2"/>    
                                            </p:inputText>
                                            
                                            <p:outputLabel value="Selecione a categoria" for="categoria"/>
                                            <p:selectOneMenu value="#{perguntaC.categoria.id}"                                                             
                                                             id="categoria"
                                                             requiredMessage="Categoria é obrigatório!" 
                                                             filter="true"
                                                             required="true">                                                       

                                                <f:selectItem itemLabel="Escolha uma categoria..." itemValue=""/>
                                                <f:selectItems value="#{categoriaC.comboCategorias}" />
                                                <p:ajax listener="#{perguntaC.setCategoriaVinculadaPergunta(categoriaC.comboCategorias)}" 
                                                        update="tab_pergunta categoria"/>
                                            </p:selectOneMenu>
                                                                    
                                        </p:panelGrid>
                                    </p:panel>
                                </p:tab>
                                
				<!--     ALTERNATIVAS      -->
                                                                
                                <p:tab id="tab_alternativas" title="Alternativas">
                                    <p:messages id="messages" showDetail="true" closable="true" >
                                        <p:autoUpdate />
                                    </p:messages>

                                    <p:panelGrid columns="2" layout="flex" contentStyleClass="ui-fluid">
                                        <p:outputLabel for="alternativa" value="" />
                                        <p:inputText id="alternativa" value="#{alternativaC.alternativa.texto}" placeholder="Digite suas alternativas *" />
                                        <p:commandButton value="Cadastrar Alternativa"
                                                         update="tabela alternativa" 
                                                         action="#{alternativaC.populaListaAlternativa()}" />
                                    </p:panelGrid>

                                    <p:dataTable id="tabela" var="alternativa" value="#{alternativaC.modelAlternativas}" rows="10">
                                        
                                        <p:column headerText="Alternativas Incluídas">
                                            <p:inputText value="#{alternativa.texto}" style="width: 100%"/>
                                        </p:column>

                                        <p:column headerText="Excluir" style="width: 9%; margin-left: 0">
                                            <p:commandButton icon="pi pi-trash" title="Excluir" process="@this"
                                                            actionListener="#{alternativaC.excluir()}" update="tabela"
                                                            styleClass="rounded-button ui-button-outlined" >
                                                
                                                <p:confirm header="Confirmação" message="Deseja realmente excluir?" icon="pi pi-info-circle"/>
                                            </p:commandButton>
                                        </p:column>                       

                                    </p:dataTable>
                                    
                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
                                        <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no ui-button-flat"/>
                                        <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" />
                                    </p:confirmDialog>
                                    
                                </p:tab>

                               <p:column headerText="Alternativas Incluídas">                                                             
                                   <p:inputText value="#{alternativa.texto}" style="width: 100%"/>
                               </p:column>

                               <p:column headerText="Excluir" style="width: 9%; margin-left: 0">
                                   <p:commandButton icon="pi pi-trash" title="Excluir" process="@this"
                                                    actionListener="#{alternativaC.excluir()}" update="tabela"
                                                    styleClass="rounded-button ui-button-outlined" >

                                       <p:confirm header="Confirmação" message="Deseja realmente excluir?" icon="pi pi-info-circle"/>
                                   </p:commandButton>
                               </p:column>                       

                               <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
                                   <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no ui-button-flat"/>
                                   <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" />
                               </p:confirmDialog>


                                <!--      CONFIRMAÇÃO     -->

                                <p:tab id="tab_confirmacao" title="Confirmação">
                                    <p:panel header="Confirmar inclusão">

                                        <h:panelGrid columns="1" columnClasses="label, value" style="margin:0 auto">
                                            <h:outputText value="Pergunta: "/>
                                            <h:outputText value="#{perguntaC.pergunta.texto}" styleClass="outputLabel"/>

                                            <h:outputText value="Categoria: "/>
                                            <h:outputText value="#{perguntaC.categoria.nome}" styleClass="outputLabel"/>

                                            <h:outputText value="Alternativas: " />
	                                            <p:dataList value="#{alternativaC.modelAlternativas}" var="alt" type="ordered">
                                                <h:outputText value="#{alt.texto}" styleClass="outputLabel" style="margin-bottom: 10px"/>
                                            </p:dataList>


                                            <!--********************-->           


<!--                                             <div style="display: flex; background-color: yellow; width: 90%">      -->
<!--                                                <ul> -->
<!--                                                   <ui:repeat value="#{alternativaC.modelAlternativas}" var="loop"> -->
<!--                                                       <h:outputLabel value="#{loop.texto}"/><br></br> -->
<!--                                                   </ui:repeat> -->
<!--                                                </ul> -->
<!--                                             </div> -->

											<!--********************--> 


                                            <br></br>
                                            <h:outputText value="Conteúdo Privado: "/>
                                            <p:selectBooleanCheckbox id="visibilidade_privada" value="#{perguntaC.pergunta.visibilidadePrivada}" >
                                                <p:ajax update="visibilidade_privada" listener="#{perguntaC.defineStatusVisibilidade()}" />
                                            </p:selectBooleanCheckbox>

                                            <p:commandButton value="Submit" actionListener="#{perguntaC.salvar()}" action="#{alternativaC.salvar(perguntaC.pergunta.id)}" 
                                                             update="growl" process="@this" style="float: right"/>
                                        </h:panelGrid>

                                    </p:panel>
                                </p:tab>
                            </p:wizard>
                        </h:form>
                    </div>  
                </p:panel>  
            </div>
        </p:panel>
    </ui:define>
</ui:composition>
