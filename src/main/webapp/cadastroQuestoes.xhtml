<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/layout.xhtml"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="content">
        <p:panel id="painel_conteudo" styleClass="color" header="Projeto TCS">
            <div id="header-name" >
                <p:panel id="panel_cadastro_questao">
                    <style type="text/css">
                        .label {
                            width: 20%;
                            padding: 4px;
                        }

                        .value {
                            width: 80%;
                            padding: 4px;
                        }

                        .grid {
                            width: 100%;
                        }

                        .error {
                            color: red;
                        }

                        .outputLabel {
                            font-weight: bold;
                        }

                        .grid {
                            width: 33%;
                            padding: 4px;
                        }
                    </style>                    
                    <div class="card">
                        
                        <h:form>
                            <p:growl id="growl" sticky="true" showDetail="true"/>

                            <p:wizard flowListener="#{perguntaC.onFlowProcess}">
                                
                                <!--      PERGUNTAS     -->
                                
                                <p:tab id="tab_pergunta" title="Pergunta">
                                    <p:messages for="Pergunta" closable="true" showIcon="false"/>
                                    <p:panel header="Cadastro de Pergunta">                                        
                                        <h:panelGrid columns="1" columnClasses="label, value" style="margin:0 auto">                                            
                                            <p:inputText id="Pergunta" value="#{perguntaC.pergunta.texto}" 
                                                         required="true" 
                                                         label=" " 
                                                         maxlength="255"
                                                         style="width:100%"
                                                         placeholder="Digite a pergunta *">
                                                <f:validateLength minimum="2"/>                                                
                                            </p:inputText>                        
                                        </h:panelGrid>
                                    </p:panel>
                                </p:tab>

                                <!--      CATEGORIAS     -->
                                
                                <p:tab id="tab_categoria" title="Categoria" >
                                    <p:messages closable="true"/>
                                    <p:panel header="Defina a categoria" >
                                        <p:messages/>
                                        <h:panelGrid columns="1" columnClasses="label, value" style="margin:0 auto" >
                                            <h:outputText value=" "/>

                                            <p:selectOneMenu value="#{perguntaC.categoria.id}"
                                                             id="categoria"                                                             
                                                             requiredMessage="Categoria é obrigatório!" 
                                                             filter="true" 
                                                             filterMatchMode="startsWith">                                                       

                                                 <f:selectItem itemLabel="Escolha uma categoria..." itemValue=""/>
                                                 <f:selectItems value="#{categoriaC.comboCategorias}" />
                                                 <p:ajax listener="#{perguntaC.setaCategoria()}" update="tab_categoria categoria"/>
                                             </p:selectOneMenu>
                                           
                                            <br></br> 
                                            
                                             <h:outputText value="Não encontrou a categoria desejada?"/>
                                             <p:inputText value="#{perguntaC.pergunta.categoria}" 
                                                          label="Categoria"
                                                          placeholder="Cadastre aqui sua categoria"
                                                          maxlength="255"
                                                          style="width:100%" />

                                        </h:panelGrid>
                                    </p:panel>
                                </p:tab>
                                
                                <!--      ALTERNATIVAS     -->
                                
                                <p:tab id="tab_alternativas" title="Alternativas">
                                    <p:messages id="messages" showDetail="true" closable="true" >
                                        <p:autoUpdate />
                                    </p:messages>

                                    <p:panelGrid columns="2" layout="flex" contentStyleClass="ui-fluid">
                                        <p:outputLabel for="alternativa" value="" />
                                        <p:inputText id="alternativa" value="#{perguntaC.alternativa.texto}" placeholder="Digite suas alternativas *" />
                                        <p:commandButton value="Cadastrar Alternativa"
                                                         update="tabela alternativa" 
                                                         action="#{perguntaC.populaListaAlternativa()}" />
                                    </p:panelGrid>

                                    <p:dataTable id="tabela" var="alternativa" value="#{perguntaC.modelAlternativas}" rows="10">
                                        
                                        <p:column headerText="Alternativas Incluídas">
                                            <p:inputText value="#{alternativa.texto}" style="width: 100%"/>
                                        </p:column>

                                        <p:column headerText="Excluir" style="width: 9%; margin-left: 0">
                                            <p:commandButton icon="pi pi-trash" title="Excluir" process="@this"
                                                            actionListener="#{perguntaC.excluir()}" update="tabela"
                                                            styleClass="rounded-button ui-button-outlined" />
                                                
                                                <!--<p:confirm header="Confirmação" message="Deseja realmente excluir?" icon="pi pi-info-circle"/>-->
                                        </p:column>                       

                                    </p:dataTable>
                                </p:tab>
                                
                                <!--      CONFIRMAÇÃO     -->

                                <p:tab id="tab_confirmacao" title="Confirmação">
                                    <p:panel header="Confirmar inclusão">
                                        
                                        <h:panelGrid columns="1" columnClasses="label, value" style="margin:0 auto">
                                            <h:outputText value="Pergunta: "/>
                                            <h:outputText value="#{perguntaC.pergunta.texto}" styleClass="outputLabel"/>

                                            <h:outputText value="Categoria: "/>
                                            <h:outputText value="#{perguntaC.categoria.nome}" styleClass="outputLabel"/>
                                            
                                            <h:outputText value="Alternativas: " />
                                            <p:dataList value="#{perguntaC.modelAlternativas}" var="alt" type="ordered">
                                                <h:outputText value="#{alt.texto}" styleClass="outputLabel" style="margin-bottom: 10px"/>
                                            </p:dataList>
                                            
                                            <br></br>
                                            <h:outputText value="Conteúdo Privado: "/>
                                            <p:selectBooleanCheckbox value="#{perguntaC.pergunta.visibilidadePrivada}" />

                                            <p:commandButton value="Submit" action="#{perguntaC.salvar()}" update="growl" process="@this" style="float: right"/>
                                        </h:panelGrid>

                                    </p:panel>
                                </p:tab>
                            </p:wizard>
                        </h:form>
                    </div>  
                </p:panel>  
            </div>
        </p:panel>
    </ui:define>
</ui:composition>
